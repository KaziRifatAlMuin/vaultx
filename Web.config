<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<connectionStrings>
		<add name="VaultXDbConnection" connectionString="Data Source=localhost\SQLEXPRESS;Initial Catalog=VaultXDb;Integrated Security=True" providerName="System.Data.SqlClient" />
	</connectionStrings>
	
	<appSettings>
		<!-- SMTP Configuration - Replace with your actual email settings -->
		<add key="SmtpEmail" value="your-app@yourdomain.com" />
		<add key="SmtpPassword" value="your-app-password" />
		<add key="SmtpHost" value="smtp.gmail.com" />
		<add key="SmtpPort" value="587" />
		
		<!-- Security Settings -->
		<add key="MaxLoginAttempts" value="5" />
		<add key="LockoutDurationMinutes" value="30" />
		<add key="SessionTimeoutMinutes" value="30" />
	</appSettings>
	
	<system.web>
		<compilation debug="true" targetFramework="4.7.2" />
		<httpRuntime targetFramework="4.7.2" maxRequestLength="10240" executionTimeout="300" />
		
		<!-- Session Configuration -->
		<sessionState 
			mode="InProc" 
			timeout="30" 
			cookieName="VaultXSession"
			cookieTimeout="30"
			cookieless="false"
			cookieSameSite="Strict"
			httpOnlyCookies="true"
			regenerateExpiredSessionId="true" />
		
		<!-- Authentication -->
		<authentication mode="Forms">
			<forms 
				loginUrl="Login.aspx" 
				defaultUrl="Home.aspx" 
				timeout="30" 
				name="VaultXAuth"
				requireSSL="false"
				slidingExpiration="true"
				cookieless="false"
				protection="All" />
		</authentication>
		
		<!-- Custom Errors -->
		<customErrors mode="On" defaultRedirect="~/Error.aspx">
			<error statusCode="404" redirect="~/NotFound.aspx" />
			<error statusCode="500" redirect="~/Error.aspx" />
		</customErrors>
		
		<!-- Security Headers -->
		<httpProtocol>
			<customHeaders>
				<add name="X-Content-Type-Options" value="nosniff" />
				<add name="X-Frame-Options" value="DENY" />
				<add name="X-XSS-Protection" value="1; mode=block" />
				<add name="Referrer-Policy" value="strict-origin-when-cross-origin" />
				<add name="Content-Security-Policy" value="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data:; font-src 'self' https://cdnjs.cloudflare.com;" />
			</customHeaders>
		</httpProtocol>
		
		<!-- Page and Request Security -->
		<pages validateRequest="true" enableEventValidation="true" viewStateEncryptionMode="Always" />
		<httpCookies httpOnlyCookies="true" requireSSL="false" lockItem="true" />
		
		<!-- Disable unnecessary features -->
		<trace enabled="false" />
		<compilation debug="true" targetFramework="4.7.2" tempDirectory="~/App_Data/Temp/" />
		
		<!-- Request Filtering -->
		<httpRuntime 
			maxRequestLength="10240"
			executionTimeout="300"
			enableVersionHeader="false"
			requestValidationMode="4.5" />
	</system.web>
	
	<system.webServer>
		<!-- Security Headers for IIS -->
		<httpProtocol>
			<customHeaders>
				<add name="X-Content-Type-Options" value="nosniff" />
				<add name="X-Frame-Options" value="DENY" />
				<add name="X-XSS-Protection" value="1; mode=block" />
				<add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains" />
			</customHeaders>
		</httpProtocol>
		
		<!-- Remove unnecessary headers -->
		<httpProtocol>
			<customHeaders>
				<remove name="Server" />
				<remove name="X-Powered-By" />
				<remove name="X-AspNet-Version" />
			</customHeaders>
		</httpProtocol>
		
		<!-- Request Filtering -->
		<security>
			<requestFiltering>
				<requestLimits maxAllowedContentLength="10485760" />
				<fileExtensions>
					<add fileExtension=".config" allowed="false" />
					<add fileExtension=".cs" allowed="false" />
					<add fileExtension=".vb" allowed="false" />
				</fileExtensions>
			</requestFiltering>
		</security>
		
		<!-- URL Rewrite for security (if available) -->
		<defaultDocument>
			<files>
				<clear />
				<add value="Home.aspx" />
				<add value="Login.aspx" />
				<add value="default.aspx" />
			</files>
		</defaultDocument>
	</system.webServer>
	
	<system.codedom>
		<compilers>
			<compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:1659;1699;1701" />
			<compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=&quot;Web&quot; /optionInfer+" />
		</compilers>
	</system.codedom>
</configuration>